{% extends 'base.template.html' %}
{%load static %}

{%block title%}
Subscription Plans Home Page
{%endblock%}

{%block content%}
<div class="alert-primary mt-3 pl-3 page-header">
  <h5> Choose New Subscription Plan</h5>
</div>


<div class="empty">
<form method="GET">
    <div class="form-group">
      <label for="inputPlan"></label>
      <select id="inputPlan" name="query" class="form-control" onchange="changePlan()">   
        <!--<option value="">Choose one of below plans...</option>-->
        <option value="biodata & crm solution plan">Biodata & CRM Solution Plan(Save &gt; 21%)</option>
        <option value="biodata plan">Biodata Plan Only</option>
        <option value="crm solution plan">CRM Solution Plan Only</option>
      </select>
    </div>
    <div class="form-group">
      <label for="inputPeriod"></label>
      <select id="inputPeriod" name="period" class="form-control" onchange="changePlan()">  
        <option value="3" selected>3 months</option>
        <option value="6">6 months (Save 5%)</option>
        <option value="12">12 months (Save 10%)</option>
      </select>
    </div>
</form>
</div>

<!--start card deck-->
<div class="card-deck">

  <div class="card card-custom-yellow">
    
    <div class="card-header">
      <h5 class="plan-type-0"><strong>BASIC</strong></h5>
      <h6 class="plan-name-0"><strong>Biodata &amp; CRM Solution Plan</strong></h6>
      <p class="plan-period-0">3 Months Plan 
      <span class="save-percent-0">(Save 21%)</span>
      </p>
    </div>
    
    
      <hr>
    
      <div class="price">
      <h4 class="mt-3">S$220/mo</h4>
      </div>
      <div class="package-content">
      <p class="card-text">100 Biodata Plan</p>
      <p class="card-text e-doc">100 Employer E-Document</p>
      <p class="card-text sub-acc">10 Sub Account User</p>
      <p class="card-text">1 Sub Domain Website</p>
      </div>
      
    <div class="card-footer">
      <button class="btn btn-yellow" type="submit">Subscribe</button>
    </div>
  </div>

  <div class="card card-custom-blue">

    <div class="card-header">
      <h5 class="plan-type-1"><strong>STANDARD</strong></h5>
      <h6 class="plan-name-1"><strong>Biodata &amp; CRM Solution Plan</strong></h6>
      <p class="plan-period-1">3 Months Plan 
      <span class="save-percent-1">(Save 22%)</span>
      </p>
      
    </div>
    
    <div class="popular-box">
    <p>Most Popular Plan</p>
    </div>
    
      <div class="price">
      <h4 class="mt-3">S$280/mo</h4>
      </div>
    
      <div class="package-content">  
      <p class="card-text">200 Biodata Plan</p>
      <p class="card-text e-doc">200 Employer E-Document</p>
      <p class="card-text sub-acc">15 Sub Account User</p>
      <p class="card-text">1 Sub Domain Website</p>
      </div>
    <div class="card-footer">
      <button class="btn btn-blue" type="submit">Subscribe</button>
    </div>
  </div>

  <div class="card card-custom-green">
    
    <div class="card-header">
      <h5 class="plan-type-2"><strong>PREMIUM</strong></h5>
      <h6 class="plan-name-2"><strong>Biodata &amp; CRM Solution Plan</strong></h6>
      <p class="plan-period-2">3 Months Plan 
      
      <span class="save-percent-2">(Save 23%)</span>
      </p>
      
    </div>
    
      <hr class="divider">
    
      <div class="price">
      <h4 class="mt-3">S$340/mo</h4>
      </div>
      <div class="package-content">
      
      <p class="card-text">300 Biodata Plan</p>
      <p class="card-text e-doc">300 Employer E-Document</p>
      <p class="card-text sub-acc">20 Sub Account User</p>
      <p class="card-text">1 Sub Domain Website</p>
     
      </div>
   
    <div class="card-footer">
      <button class="btn btn-green" type="submit">Subscribe</button>
    </div>
  </div>  <!--ends green card-->

</div> <!--end card-deck-->

<p class="mt-3"> **Your newly purchased plan will only take effect after your current subscription expires. </p>
{%endblock%}


{%block js%}
<script src="{% static '/js/main.js' %}"></script>

<script>
function changePlan() {

    var home_route = '/change-plans';
    var searchPlan=document.getElementById("inputPlan").value;
    var searchPeriod=document.getElementById("inputPeriod").value;
    
    searchPlan = encodeURIComponent(searchPlan);
    var url = home_route+"?query="+searchPlan+"&period="+searchPeriod;

    const myHeaders = new Headers();
    const myRequest = new Request(url, {
    method: 'GET',
    headers: myHeaders,
    mode: 'cors',
    cache: 'default',
    });
    
    //changeDisplay
    fetch(myRequest).then(response => response.json()).then(function(json){
        console.log(json);
        console.log(json.plans);
        for (let i=0; i<3; i++){
            console.log(json.plans[i].plan_type);
            document.querySelector('.plan-type-'+i).innerText = json.plans[i].plan_type;
            document.querySelector('.plan-name-'+i).innerText = json.plans[i].name;
            document.querySelector('.plan-period-'+i).innerText = json.plans[i].subscription_period;
        }
        });
  
}
</script>

{% endblock %}